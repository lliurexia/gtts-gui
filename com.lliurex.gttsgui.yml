app-id: com.lliurex.gttsgui
runtime: org.kde.Platform
runtime-version: '6.5'
sdk: org.kde.Sdk
command: gtts-gui
finish-args:
  - --share=network
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --device=dri
  - --socket=pulseaudio
  - --filesystem=xdg-music:rw
  - --filesystem=xdg-download:rw
modules:
  - name: python3-modules
    buildsystem: simple
    build-commands:
      - pip3 install --no-index --find-links="file://${PWD}" --prefix=${FLATPAK_DEST} .
    sources:
      - type: file
        path: requirements.txt
      - type: dir
        path: .

  - name: gtts-gui
    buildsystem: simple
    build-commands:
      - install -D main.py ${FLATPAK_DEST}/bin/gtts-gui
      - install -D gtts-gui.desktop ${FLATPAK_DEST}/share/applications/com.lliurex.gttsgui.desktop
      - mkdir -p ${FLATPAK_DEST}/share/icons/hicolor/scalable/apps/
      - cp icons/gtts-gui.svg ${FLATPAK_DEST}/share/icons/hicolor/scalable/apps/com.lliurex.gttsgui.svg
      - cp -r locale ${FLATPAK_DEST}/share/
      - cp -r assets ${FLATPAK_DEST}/share/gtts-gui/
      - cp supported_domains.txt ${FLATPAK_DEST}/share/gtts-gui/
      - cp about_dialog.py ${FLATPAK_DEST}/lib/python3.*/site-packages/
    sources:
      - type: dir
        path: .
